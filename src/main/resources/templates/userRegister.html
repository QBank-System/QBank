<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Layui</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../static/frame/layui/css/layui.css" media="all">
    <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->
</head>
<body>

<table class="layui-table" id="test3" lay-filter="test3"></table>
<script type="text/html" id="toolbarDemo">
    <div class="layui-btn-container">
        <button class="layui-btn layui-btn-sm" lay-event="addUser"><i class="layui-icon">&#xe624;</i>添加</button>
        <button class="layui-btn layui-btn-sm" lay-event="delSelectedUsers"><i class="layui-icon">&#xe640;</i>删除选中
        </button>
        <button class="layui-btn layui-btn-sm" lay-event="addUserFromExcl"><i class="layui-icon">&#xe67c;</i>从文件导入
        </button>
        <button class="layui-btn layui-btn-sm" lay-event="registerSelectedUser"><i class="layui-icon">&#xe605;</i>完成并注册
        </button>
    </div>
</script>
<script src="../static/frame/layui/layui.js" charset="utf-8"></script>
<script src="../static/frame/jquery/jquery.js" charset="utf-8"></script>
<!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
<script>

    var newUsers = [{
        "id": 1,
        "userName": "",
        "userWorkNumber": "",
        "userPassword": "",
        "userCollege": "",
        "userPhoneNumber": ""
    }];
    layui.use('table', function () {
        var table = layui.table;

        table.render({
            elem: '#test3'
            , cols: [
                [
                    {checkbox: true, fixed: true}
                    , {field: 'userName', title: '姓名', edit: 'text'}
                    , {field: 'userWorkNumber', title: '学工号', edit: 'text', sort: true}
                    , {field: 'userPassword', title: '密码', edit: 'text'}
                    , {field: 'userCollege', title: '所属学院', edit: 'text'}
                    , {field: 'userPhoneNumber', title: '电话号码', edit: 'text'}
                ]
            ]
            , defaultToolbar: ['filter', 'exports']
            , toolbar: '#toolbarDemo'
            , id: 'testReload'
            , page: true
            , data: newUsers
        });

        //监听单元格编辑
        table.on('edit(test3)', function (obj) {
            var value = obj.value //得到修改后的值
                , data = obj.data //得到所在行所有键值
                , field = obj.field; //得到字段
            //layer.msg('[ID: ' + data.id + '] ' + field + ' 字段更改为：' + value);
        });
        //头工具栏事件
        table.on('toolbar(test3)', function (obj) {
            var checkStatus = table.checkStatus(obj.config.id);
            switch (obj.event) {
                case 'addUser':
                    const user = {
                        "id": newUsers.length+1,
                        "userName": "",
                        "userWorkNumber": "",
                        "userPassword": "",
                        "userCollege": "",
                        "userPhoneNumber": ""
                    };
                    newUsers.push(user);
                    break;
                case 'delSelectedUsers':
                    for(let i = 0 ; i < newUsers.length;i++){
                        if(newUsers[i]["LAY_CHECKED"]===true){
                            newUsers.splice(i,1);
                            i--;
                        }
                    }
                    break;
                case 'addUserFromExcl':
                    layer.msg(checkStatus.isAll ? '全选' : '未全选');
                    break;
                case 'registerSelectedUser':
                    layer.msg(checkStatus.isAll ? '全选' : '未全选');
                    break;

                //自定义头工具栏右侧图标 - 提示
                case 'LAYTABLE_TIPS':
                    layer.alert('这是工具栏右侧自定义的一个图标按钮');
                    break;
            }
            $(".layui-laypage-btn").click();

        });
    });
</script>

</body>
</html>